<div fxLayout="row"
     fxLayoutAlign="space-evenly start"
     fxLayout.xs="column"
     fxLayout.sm="column"
     fxLayoutAlign.xs="space-evenly center"
     fxLayoutAlign.sm="space-evenly center"
     fxLayoutGap="5px">
    <div fxFlex="50">
        <mat-card class="card">
            <mat-card-content>
                <div fxLayout="row" fxLayout.xs="column" fxLayoutAlign="space-around center">
                    <div>
                        <img class="cardImage" src="{{book.image}}">
                    </div>
                    <div fxFlexOffset="1" fxLayout.xs="column">
                        <div fxLayout="row" fxLayoutAlign="space-around center">
                            <h2>{{book.title}}</h2>
                        </div>
                        <div fxLayout="row" fxLayoutAlign="space-between center">
                            <div fxFlex="40">
                                {{stringAuthors}}
                            </div>
                            <div *ngIf="book.averageRating">
                                <app-rating *ngFor="let star  of stars;" [idStar]="star"
                                            [rating]="this.book.averageRating"></app-rating>
                            </div>
                        </div>
                        <div fxLayout="row" fxLayoutAlign="end center">
                            <button type="button" *ngIf="book.idUserBook? false : true" mat-flat-button color="accent"
                                    (click)="openDialogAddBook(book)">
                                {{'ESTANTE.ADICIONAR_LIVRO' | translate}}
                            </button>
                            <button type="button" *ngIf="book.idUserBook" mat-flat-button color="accent"
                                    (click)="openDialogAddBook(book)">
                                {{'ESTANTE.EDITAR_LIVRO' | translate}}
                            </button>
                        </div>

                    </div>
                </div>
                <div fxLayout="row" fxLayoutAlign="space-between center">
                    <p class="description">{{book.description}}</p>
                </div>
                <mat-list>
                    <mat-divider></mat-divider>
                    <mat-list-item>{{'BOOK.OUTRAS_INFO' | translate}}</mat-list-item>
                    <div fxLayout="row" fxLayoutAlign="space-around center">
                        <div fxFlex="20"><strong>{{'BOOK.EDITORA' | translate}}</strong></div>
                        <div fxFlex="20"><strong>{{'BOOK.PUPLICACAO' | translate}}</strong></div>
                        <div fxFlex="20"><strong>{{'BOOK.PAGINAS' | translate}}</strong></div>
                    </div>
                    <div fxLayout="row" fxLayoutAlign="space-around center">
                        <div fxFlex="20"><p> {{book.publisher}}</p></div>
                        <div fxFlex="20"><p> {{book.publishedDate}}</p></div>
                        <div fxFlex="20"><p> {{book.numberPage}}</p></div>
                    </div>
                    <div fxLayout="row" fxLayoutAlign="space-around center">
                        <div fxFlex="20"><strong>{{'BOOK.IDIOMA' | translate}}</strong></div>
                        <div fxFlex="20"><strong>{{'BOOK.AVALIACAO' | translate}}</strong></div>
                        <div fxFlex="20"></div>
                    </div>
                    <div fxLayout="row" fxLayoutAlign="space-around center">
                        <div fxFlex="20"><p> {{book.language}}</p></div>
                        <div fxFlex="20"><p> {{book.averageRating}}</p></div>
                        <div fxFlex="20"></div>
                    </div>
                </mat-list>
                <br>
            </mat-card-content>
        </mat-card>
    </div>
    <div fxLayout="column" fxLayoutAlign="space-between center" fxFlex="50" *ngIf="book.idUserBook" >
        <div fxLayout="row" fxLayoutAlign="center center">
            <h2>{{'ACOMP_LEITURA.ACOMP_LEITURA' | translate}}</h2>
        </div>
        <div class="acompanhamento">
            <mat-expansion-panel
                    [expanded]="true"
                    (opened)="panelOpenState = true"
                    (closed)="panelOpenState = false">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        {{'ACOMP_LEITURA.ACOMP_LEITURA' | translate}}
                    </mat-panel-title>
                    <mat-panel-description>

                    </mat-panel-description>
                </mat-expansion-panel-header>
                <div fxLayout="row" fxLayoutAlign="space-between center" >
                    <div><b>Total</b></div>
                    <div> {{trackings.length}}</div>
                </div>
                <div fxLayout="row" fxLayoutAlign="space-between center" >
                    <div><b>{{'PADRAO.CONCLUIDO' | translate}}</b></div>
                    <div> {{ getConcluidos('concluido')}} </div>
                </div>
                <div fxLayout="row" fxLayoutAlign="space-between center" >
                    <div><b>{{'PADRAO.PENDENTE' | translate}}</b></div>
                    <div> {{ getConcluidos('pending')}}</div>
                </div>
            </mat-expansion-panel>
        </div>
        <div fxLayout="row" fxLayoutAlign="space-evenly center" fxLayoutGap="5px" fxLayout.xs="row">
            <mat-form-field>
                <mat-label>{{'PADRAO.BUSCAR' | translate}}</mat-label>
                <input matInput type="text" [(ngModel)]="search">
            </mat-form-field>
            <button
                    (click)="openDialogTrackingView(null)"
                    type="button"
                    mat-flat-button
                    color="accent">
                {{'ACOMP_LEITURA.NEW' | translate}}
            </button>
        </div>
        <div *ngFor="let tracking of trackings, let  i = index" class="acompanhamento">
            <mat-expansion-panel
                    [expanded]="false"
                    (opened)="panelOpenState = true"
                    (closed)="panelOpenState = false">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        {{'ACOMP_LEITURA.ACOMPANHAMENTO' | translate}} {{trackings.length - i}}
                    </mat-panel-title>
                    <mat-panel-description>
                            {{ getStatusTranslate(tracking.trackings) | translate}}
                    </mat-panel-description>
                </mat-expansion-panel-header>
                {{'PADRAO.COMENTARIO' | translate}}: {{tracking.comentario}}
                <div>
                    <div fxLayout="row" fxLayoutGap="5px" fxLayoutAlign="space-between center">
                        <mat-progress-bar color="accent" mode="determinate" [value]="this.getPercentTotal(tracking.trackings)"></mat-progress-bar>
                        <div style="position: absolute; color: white; padding-left: 10px;"> {{this.getPercentTotal(tracking.trackings) | number}}%</div>
                        <button

                                style="width: 100px" type="button" *ngIf="tracking.trackings ? tracking.trackings[tracking.trackings.length -1]?.percentage.toString() !== '100' : true "
                                mat-flat-button
                                color="accent"
                                (click)="openDialogReadingTracking(tracking.trackings,null, false, tracking.id)">
                            {{'PADRAO.ADICIONAR' | translate}}
                        </button>
                    </div>

                    <br>
                    <div fxLayout="column"
                         fxLayout.xs="column"
                         fxLayoutGap="10px" fxLayoutAlign="space-between center">
                        <mat-card class="trackings" *ngFor="let readingTracking of orderByDate(tracking.trackings), let i = index;"
                                  [ngStyle]="{
                              'background': readingTracking === orderByDate(tracking.trackings)[0] ? '#ebfff5' : ''
                              }">
                            <div fxLayout="row" fxLayoutAlign="space-around center">
                                <div fxFlex="30"><strong>{{readingTracking.creationDate | date}}</strong></div>
                                <div fxFlex="10"><strong>{{readingTracking.percentage | number:'1.1-2'}}%</strong></div>
                                <div fxFlex="10">{{readingTracking.numPag}}</div>
                                <button mat-mini-fab color="accent"
                                        aria-label="Example icon button with a filter list icon"
                                        (click)="openDialogReadingTracking(tracking.trackings, readingTracking, true, tracking.id)">
                                    <mat-icon>create</mat-icon>
                                </button>

                            </div>
                            <div fxLayout="row" fxLayoutAlign="center center">
                                <div>{{readingTracking.comentario}}</div>
                            </div>
                        </mat-card>
                        <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="5px">
                            <button mat-flat-button color="warn" (click)="delete(tracking.id)">
                                {{'PADRAO.REMOVER' | translate}}
                            </button>
                            <button mat-flat-button color="accent" (click)="openDialogTrackingView(tracking)">
                                {{'PADRAO.EDITAR' | translate}}
                            </button>
                        </div>
                    </div>
                </div>
            </mat-expansion-panel>
        </div>
    </div>

</div>